#include "RBTree.h"
#include <time.h>

typedef struct KEY
{
	int a;
	float b;
}KEY;

typedef struct VALUE
{
	int a;
	float b;
	char c;
}VALUE;

bool key_equal(const void* lhs, const void* rhs)
{
	const KEY* _lhs = lhs;
	const KEY* _rhs = rhs;
	return _lhs->a == _rhs->a && _lhs->b == _rhs->b;
}

bool key_less(const void* lhs, const void* rhs)
{
	const KEY* _lhs = lhs;
	const KEY* _rhs = rhs;
	if (_lhs->a == _rhs->a)
		return _rhs->b < _lhs->b;
	return _rhs->a < _lhs->a;
}

void foreach(const void* key, void* val)
{
	const KEY* _key = key;
	const VALUE* _val = val;
	printf("key:%d\t%f\tval:%d\t%f\n", _key->a, _key->b, _val->a, _val->b);
}

int main()
{
	RBTree* tree = RBTree().create(sizeof(KEY), sizeof(VALUE), key_equal, key_less);
	KEY key = {1,1.1};
	VALUE val = {10, 1.1, 'c'};
	// for (size_t i = 0; i < 20; i++){
	// 	key.a = rand()%100;
	// 	key.b = rand()%100 + 0.25;
	// 	val.a = rand()%100;
	// 	val.b = rand()%100 + 0.25;
	// 	// printf("key:%d\t%f\tval:%d\t%f\n", key.a, key.b, val.a, val.b);
	// 	RBTree().insert(tree, &key, &val);
	// }
	// puts("=========================");
	// RBTree().level_order_traverse(tree, foreach);

	// puts("=========================");
	// key.a = 83;
	// key.b = 86.25;
	// RBTree().erase(tree, &key);
	// RBTree().level_order_traverse(tree, foreach);

	// int arry[] = {2,8,10,15,25,27,32,50,55,60,78,80,455,421,566,43,44,224,3,45,64,4,21,41,54,5};
	// int arry[] = {2,8,10,15,25,27};
	int arry[] = {537,740,251,226,782,159,866,45,902,355,898,55,80,435,181,594,566,778,263,516,25,749,880,138,381,717,299,
		513,861,713,412,249,382,931,666,59,455,926,141,96,37,862,525,422,328,33,852,354,261,293,563,234,673,305,213,390,558,
		92,937,142,508,23,832,156,42,415,77,476,806,425,574,465,242,578,967,424,136,929,29,682,748,98,951,743,698,968,44,550,
		375,195,760,372,398,327,198,630,269,691,122,139,200,952,413,232,648,112,356,695,790,280,989,84,587,780,386,69,529,204,
		454,462,950,437,839,728,604,704,527,97,746,178,140,193,611,636,57,429,290,716,613,510,30,118,83,772,427,171,205,752,105,
		210,417,143,833,662,473,463,190,466,815,775,119,841,187,973,859,541,368,460,700,304,567,875,93,846,191,203,542,877,849,
		407,289,201,739,225,601,343,325,480,921,723,906,518,763,71,565,113,910,175,626,610,292,286,60,478,805,442,590,834,965,
		983,401,523,803,766,576,865,798,158,469,342,346,357,168,608,494,702,472,388,496,202,91,154,851,668,68,399,403,734,804,
		757,514,960,627,345,76,180,600,694,370,568,352,784,124,252,400,581,500,408,919,351,639,87,659,279,886,186,166,726,977,
		709,86,58,596,56,533,612,754,656,306,511,179,274,493,667,801,432,31,811,661,110,927,655,456,618,522,769,633,444,796,389,
		449,61,79,822,7,598,39,65,788,831,829,584,546,331,169,777,729,95,78,718,628,123,132,446,643,266,885,8,640,383,582,491,
		268,317,135,711,492,621,820,887,721,338,954,850,654,262,795,791,776,750,907,5,955,679,724,148,475,467,619,495,277,323,845,
		402,722,872,395,10,162,705,879,17,239,28,312,320,966,451,365,276,81,649,438,674,817,714,629,712,21,725,517,889,896,116,
		764,66,360,324,27,125,486,939,947,428,580,502,503,814,753,497,100,102,431,623,144,617,416,295,810,405,85,934,283,303,448,
		229,107,177,220,519,897,869,302,559,63,207,464,414,895,236,882,172,999,233,818,104,364,117,130,174,963,914,813,436,925,809,
		863,297,745,426,48,835,36,167,870,591,32,646,241,211,434,291,106,572,624,294,669,528,675,89,876,945,645,856,224,561,196,
		361,848,672,555,768,956,554,602,470,347,733,532,571};//都是不一样的


	for (size_t i = 0; i < sizeof(arry) / sizeof(int); i++){
		key.a = arry[i];
		RBTree().insert(tree, &key, &val);
	}
	// puts("=========================");
	// RBTree().level_order_traverse(tree, foreach);

	int ssss[] = {537,740,251,226,782,159,866,45,902,355,898,55,80,435,181,594,566,778,263,516,25,749,880,138,381,717,299,
		513,861,713,412,249,382,931,666,59,455,926,141,96,37,862,525,422,328,33,852,354,261,293,563,234,673,305,213,390,558,
		92,937,142,508,23,832,156,42,415,77,476,806,425,574,465,242,578,967,424,136,929,29,682,748,98,951,743,698,968,44,550,
		375,195,760,372,398,327,198,630,269,691,122,139,200,952,413,232,648,112,356,695,790,280,989,84,587,780,386,69,529,204,
		454,462,950,437,839,728,604,704,527,97,746,178,140,193,611,636,57,429,290,716,613,510,30,118,83,772,427,171,205,752,105,
		210,417,143,833,662,473,463,190,466,815,775,119,841,187,973,859,541,368,460,700,304,567,875,93,846,191,203,542,877,849,
		407,289,201,739,225,601,343,325,480,921,723,906,518,763,71,565,113,910,175,626,610,292,286,60,478,805,442,590,834,965,
		983,401,523,803,766,576,865,798,158,469,342,346,357,168,608,494,702,472,388,496,202,91,154,851,668,68,399,403,734,804,
		757,514,960,627,345,76,180,600,694,370,568,352,784,124,252,400,581,500,408,919,351,639,87,659,279,886,186,166,726,977,
		709,86,58,596,56,533,612,754,656,306,511,179,274,493,667,801,432,31,811,661,110,927,655,456,618,522,769,633,444,796,389,
		449,61,79,822,7,598,39,65,788,831,829,584,546,331,169,777,729,95,78,718,628,123,132,446,643,266,885,8,640,383,582,491,
		268,317,135,711,492,621,820,887,721,338,954,850,654,262,795,791,776,750,907,5,955,679,724,148,475,467,619,495,277,323,845,
		402,722,872,395,10,162,705,879,17,239,28,312,320,966,451,365,276,81,649,438,674,817,714,629,712,21,725,517,889,896,116,229,
		107,177,220,519,897,869,302,559,63,207,464,414,895,236,882,172,999,233,818,104,364,117,130,174,963,914,813,436,925,809,
		863,297,745,426,48,835,36,167,870,591,32,646,241,211,434,291,106,572,624,294,669,528,675,89,876,945,645,856,224,561,196,
		361,848,672,555,768,956,554,602,470,347,733,532,571};
	// int ssss[] = {326,600,625,687,384,958,526,948,420,203,24,808,770,165,618,343,348,136,85,402,781,289,
	// 	598,829,539,197,951,935,975,704,364,271,202,801,37,242,80,796,773,576,706,968,334,175,21,78,577,
	// 	599,494,877,75,601,510,559,401,258,664,459,826,541,137,690,959,219,279,668,229,993,71,270,728,146,
	// 	661,836,512,743,933,267,838,769,614,185,774,853,498,864,284,919,595,979,607,798,};

	// int ssss[] = {2,8,10,15,25,27};
	for (size_t i = 0; i < sizeof(ssss) / sizeof(int); i++){
		key.a = ssss[i];
		RBTree().erase(tree, &key);
	}

	int arry1[] = {1001,1500,1201,1670,1355,1488,1999};
	for (size_t i = 0; i < sizeof(arry1) / sizeof(int); i++){
		key.a = arry1[i];
		RBTree().insert(tree, &key, &val);
	}
	int ssss1[] = {
		764,66,360,324,27,125,486,939,947,428,580,502,503,814,753,497,100,102,431,623,144,617,416,295,810,405,85,934,283,303,448,
	};
	for (size_t i = 0; i < sizeof(ssss1) / sizeof(int); i++){
		key.a = ssss1[i];
		RBTree().erase(tree, &key);
	}

	puts("=========================");
	RBTree().level_order_traverse(tree, foreach);
	// puts("=========================");
	// RBTree().traverse(tree, foreach);
	// puts("=========================");
	// RBTree().clear(tree);
	// RBTree().level_order_traverse(tree, foreach);

	RBTree().destroy(&tree);
	return 0;
}